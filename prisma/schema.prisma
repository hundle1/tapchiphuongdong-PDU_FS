generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["relationJoins"]
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model TaiKhoanNguoiDung {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("USER")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  magazines Magazine[]

  @@map("users")
}

model Magazine {
  id                  String             @id @default(cuid())
  tieuDe              String
  tenTacGia           String?
  moTa                String?
  anhBiaLocal         String? // link local storage
  anhBiaUrl           String? // link Url online
  fileUpload          File?              @relation(fields: [fileUploadId], references: [id])
  fileUploadId        String?
  soTrang             Int?
  trangThai           String             @default("draft")
  ngayXuatBan         DateTime?
  TaiKhoanNguoiDung   TaiKhoanNguoiDung? @relation(fields: [taiKhoanNguoiDungId], references: [id])
  taiKhoanNguoiDungId String?
  categoryName        Category[] // üëà nhi·ªÅu category
  major               Major[]
  readCount           Int                @default(0)
  likeCount           Int                @default(0)
  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt
}

model Major {
  id        String     @id @default(cuid())
  name      String     @unique
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  magazines Magazine[] // üëà nhi·ªÅu magazine
}

model Category {
  id        String     @id @default(cuid())
  name      String     @unique
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  magazines Magazine[] // üëà nhi·ªÅu magazine
}

model File {
  id        String     @id @default(cuid())
  fileName  String
  fileType  String
  fileUrl   String // link Supabase S3 ho·∫∑c local storage
  createdAt DateTime   @default(now())
  Magazine  Magazine[]
}
